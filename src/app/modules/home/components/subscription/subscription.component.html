<div class="flex flex-col justify-content-around mx-6 sm:mx-4 overflow-auto h-[90%]" >
  <div class="my-1">
    <app-header-toolbar routerlink="/home" pagetitle="Subscription" ></app-header-toolbar>
  </div>

  <div class="flex flex-col sm:flex-row w-full">
    <div class="w-full flex flex-row sm:block px-2 sm:px-4 md:px-8 py-2 sm:py-8 sm:w-1/5  bg-[#000] sm:bg-[#f8f8f8] sm:mx-4 items-center sm:items-start justify-center rounded-2xl sm:rounded-[50px] sm:space-y-4">
      <div
        class="font-[GilroyBold] cursor-pointer py-4  sm:py-2 md:py-4 px-4 sm:px-1 m-auto w-[80%] sm:w-full md:w-[80%] justify-center text-center text-[#ff6782] bg-black sm:bg-[#f8f8f8] rounded-2xl text-sm sm:text-sm md:text-base"
        [routerLink]="['/home/profile']" 
        routerLinkActive="active_button">
        Profile Information
      </div>
      <div
        class="font-[GilroyBold] cursor-pointer py-4 sm:py-2 md:py-4  px-4 sm:px-1 m-auto w-[80%] sm:w-full md:w-[80%]  justify-center text-center rounded-2xl text-[#ff6782] bg-black sm:bg-[#f8f8f8] text-sm sm:text-sm md:text-base"
        [routerLink]="['/home/subscription']" 
        routerLinkActive="active_button">
        Subscription
      </div>
    </div>
    <div
      class="w-full space-y-2 sm:w-4/5 sm:bg-[#f8f8f8] sm:mx-4 sm:px-10 mt-6 sm:mt-0 sm:pt-6 pb-2 items-center justify-center sm:rounded-[50px] overflow-auto h-[70vh] sm:h-[75vh]">

      <div class="bg-white rounded-3xl p-5 md:flex block items-center justify-between mt-3">
        <div class="flex flex-row space-x-10 sm:space-x-3 w-full sm:w-fit">
          <div class="bg-[#ffeaee] rounded-2xl p-[25px] sm:w-fit" [ngClass]="{'w-full': !this.isAnyActiveSubscription,'w-fit':this.isAnyActiveSubscription}">
            <svg xmlns="http://www.w3.org/2000/svg" class="m-auto" width="28.616" height="33.994" viewBox="0 0 28.616 33.994">
              <g id="Group_3988" data-name="Group 3988" transform="translate(-7141.982 -2108.458)">
                <path id="Path_4258" data-name="Path 4258" d="M7157.218,2108.458c.617.108,1.246.171,1.85.331a12.288,12.288,0,0,1,9.471,9.6,12.061,12.061,0,0,1-2.465,10.567.36.36,0,0,0-.034.487c1.443,2.458,2.875,4.923,4.315,7.383a1.274,1.274,0,0,1,.175,1.134,1.192,1.192,0,0,1-1.533.729c-1.122-.328-2.242-.664-3.363-1-.084-.025-.17-.042-.284-.07-.168.484-.334.96-.5,1.436-.288.834-.58,1.667-.86,2.5a1.205,1.205,0,0,1-2.243.21c-.919-1.612-1.847-3.22-2.767-4.832a1.187,1.187,0,1,1,2.06-1.167c.449.773.892,1.552,1.337,2.327.054.094.112.184.188.309.3-.874.589-1.707.881-2.538a1.188,1.188,0,0,1,1.588-.827c.571.165,1.143.333,1.715.5.018.005.041-.009.1-.022l-2.664-4.57c-5.263,3.663-10.508,3.689-15.832.075l-2.645,4.531c.135-.027.214-.037.29-.059.519-.151,1.036-.308,1.556-.457a1.185,1.185,0,0,1,1.57.809c.265.749.521,1.5.782,2.25.031.089.064.177.115.315.49-.854.949-1.671,1.428-2.476a1.732,1.732,0,0,1,.453-.515,1.145,1.145,0,0,1,1.411.1,1.172,1.172,0,0,1,.289,1.391c-.193.385-.422.751-.636,1.125-.7,1.227-1.413,2.45-2.106,3.682a1.212,1.212,0,0,1-2.286-.2c-.4-1.2-.824-2.4-1.239-3.6-.032-.092-.066-.184-.11-.307l-1.848.541c-.572.168-1.142.339-1.713.506a1.185,1.185,0,0,1-1.43-.371,1.227,1.227,0,0,1-.006-1.48c1.417-2.409,2.816-4.829,4.236-7.236a.418.418,0,0,0-.054-.571,11.892,11.892,0,0,1-2.729-6.537,12.358,12.358,0,0,1,5.891-12.112,11.684,11.684,0,0,1,5.369-1.839,2.392,2.392,0,0,0,.285-.064Zm-11.263,12.611a10.265,10.265,0,1,0,10.3-10.237A10.278,10.278,0,0,0,7145.955,2121.069Z" fill="#ff6782"/>
                <path id="Path_4259" data-name="Path 4259" d="M7228.781,2178.992a5.758,5.758,0,0,1-.616-.218q-1.535-.742-3.061-1.507a.463.463,0,0,0-.487.01c-1.009.549-2.026,1.083-3.036,1.628a1.37,1.37,0,0,1-1.088.126,1.044,1.044,0,0,1-.751-1.208c.165-1.125.336-2.25.526-3.37a.625.625,0,0,0-.221-.661c-.8-.711-1.581-1.452-2.379-2.169a1.208,1.208,0,0,1-.444-1.326,1.2,1.2,0,0,1,1.095-.865c1.1-.158,2.2-.348,3.3-.52a.548.548,0,0,0,.473-.338c.46-.991.956-1.966,1.419-2.956a1.214,1.214,0,0,1,2.266-.05c.508.981,1.034,1.952,1.542,2.933a.472.472,0,0,0,.42.294c1.175.132,2.346.293,3.519.443a1.122,1.122,0,0,1,.983.818,1.136,1.136,0,0,1-.322,1.241c-.795.785-1.587,1.573-2.395,2.346a.58.58,0,0,0-.192.608c.221,1.059.428,2.12.631,3.182A1.25,1.25,0,0,1,7228.781,2178.992Zm-4.077-10.38c-.248.511-.508.953-.684,1.426a1.636,1.636,0,0,1-1.577,1.14c-.476.032-.946.149-1.484.238.436.4.8.776,1.2,1.1a1.5,1.5,0,0,1,.551,1.648c-.111.5-.162,1.014-.249,1.585.547-.291,1.05-.522,1.513-.815a1.528,1.528,0,0,1,1.712-.021c.474.268.977.486,1.517.75-.12-.624-.207-1.19-.342-1.745a1.374,1.374,0,0,1,.462-1.427c.4-.377.764-.791,1.168-1.214-.474-.06-.94-.152-1.409-.17a1.649,1.649,0,0,1-1.63-1.067C7225.254,2169.562,7224.975,2169.119,7224.7,2168.611Z" transform="translate(-68.517 -51.357)" fill="#ff6782"/>
              </g>
            </svg>
            
          </div>
          <div *ngIf="this.isAnyActiveSubscription" class="w-1/2">
            <p class="text-md font-bold mb-1">Current plan</p>
            <p class="text-sm font-bold mb-2">
              {{this.currentPlan['amount']}}<span class="text-gray-400 font-bold text-sm">/month</span>
            </p>
            <!-- <button class="text-sm text-red font-bold">Change Plan</button> -->

          </div>
        </div>
        <div *ngIf="!this.isAnyActiveSubscription" class="text-center w-full font-['GilroySemi'] text-lg sm:text-xl">No Active Plans Found ,Please subscribe to create Will. </div>
        <div *ngIf="this.isAnyActiveSubscription" class="flex">
          <div class="mr-5">
            <p class="text-gray-400 font-[GilroySemi] text-sm mb-1">
              Subscription Start date
            </p>
            <p class="text-dark font-bold text-sm">{{this.currentPlan['startDate']}}</p>
          </div>
          <div>
            <p class="text-gray-400 font-[GilroySemi] text-sm mb-1">
              Subscription End date
            </p>
            <p class="text-dark font-bold text-sm">{{this.currentPlan['endDate']}}</p>
          </div>
        </div>
      </div> 

      <div class="font-bold text-lg mt-5">Subscription Plans</div>
      <div class="bg-white rounded-3xl p-5 flex items-center justify-between mt-3 cursor-pointer" (click)="selectPlan('0', 'free','price_1KjO1cJrEVeMChFEiW4aBXDE')"  [ngClass]="{'border-2 border-[#ff6782]': obj.priceId==='price_1KjO1cJrEVeMChFEiW4aBXDE','cursor-not-allowed':!isfreeTrialValid}">
        <div class="w-full">

          <div class="flex flex-row justify-between">
            <div class="text-gray-400 font-[GilroyBold] tracking-wider text-sm mb-1">FREE</div>
            <div *ngIf="this.currentPlan['priceId'] === 'price_1KjO1cJrEVeMChFEiW4aBXDE'" class="flex flex-row space-x-1">
              <div class="flex items-center"><img src="../../../../../assets/Icons/active.svg"/></div>
              <div class="font-['GilroySemi'] text-lg">Active</div>
            </div>
          </div>
          <p class="text-md font-bold mb-1">1 month trial</p>
          <p class="text-gray-400 font-[Gilroy] text-sm mb-3">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
            eiusmod tempor incididunt ut labore et dolore magna aliqua.
          </p>
          <button class="text-sm text-red font-bold "  (click)="toggleModalCancel=true" *ngIf="!this.currentPlan['isCancelled'] && this.currentPlan['priceId'] === 'price_1KjO1cJrEVeMChFEiW4aBXDE'">Cancel anytime.</button>
          <div class="text-sm text-red font-bold " *ngIf="this.currentPlan['isCancelled'] && this.currentPlan['priceId'] === 'price_1KjO1cJrEVeMChFEiW4aBXDE'">Your Plan Wil be end in {{this.endDays}} days</div>
        </div>
        <div class="flex">
          <input type="radio" [disabled]="!isfreeTrialValid" [checked]="obj.priceId==='price_1KjO1cJrEVeMChFEiW4aBXDE'" name="specifyOwnershipType" value="sole" id="test1" class="mx-1 radioCustom" />
          <label class="text-sm mx-1 mt-1" for="test1"></label>
        </div>
      </div>

      <div class="bg-white rounded-3xl p-5 flex items-center justify-between mt-3 border-2 cursor-pointer" (click)="selectPlan( '1700','month','price_1Kj18mJrEVeMChFE8FQtb5bm')"  [ngClass]="{'border-2 border-[#ff6782]': obj.priceId==='price_1Kj18mJrEVeMChFE8FQtb5bm'}">
        <div class="w-full">
          <div class="flex flex-row justify-between">
            <div class="text-gray-400 font-[GilroyBold] tracking-wider text-sm mb-1">Monthly</div>
            <div *ngIf="this.currentPlan['priceId'] === 'price_1Kj18mJrEVeMChFE8FQtb5bm'" class="flex flex-row space-x-1">
              <div class="flex items-center"> <img src="../../../../../assets/Icons/active.svg"/></div>
              <div class="font-['GilroySemi'] text-lg">Active</div>
            </div>
          </div>
          <p class="text-md font-bold mb-1">$1700/monthly</p>
          <p class="text-gray-400 font-[Gilroy] text-sm mb-3">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
            eiusmod tempor incididunt ut labore et dolore magna aliqua.
          </p>
          <button class="text-sm text-red font-bold " (click)="toggleModalCancel=true"  *ngIf="!this.currentPlan['isCancelled'] && this.currentPlan['priceId'] === 'price_1Kj18mJrEVeMChFE8FQtb5bm'">Cancel anytime.</button>
          <div class="text-sm text-red font-bold " *ngIf="this.currentPlan['isCancelled'] && this.currentPlan['priceId'] === 'price_1Kj18mJrEVeMChFE8FQtb5bm'">Your Plan Wil be end in {{this.endDays}} days</div>
        </div>
        <div class="flex">
          <input type="radio" [checked]="obj.priceId==='price_1Kj18mJrEVeMChFE8FQtb5bm'" name="specifyOwnershipType" value="sole" id="test2" class="mx-1 radioCustom" />
          <label class="text-sm mx-1 mt-1" for="test2"></label>
        </div>
      </div>
      <div *ngIf="!this.isAnyActiveSubscription" class="w-full sm:w-3/4 md:w-5/12 lg:w-3/12 mt-1">

        <app-button
        [arrow]="true"
        (myMethod)="upgradePlan()"
        padding="px-5 py-3 "
        value="Subscribe Now"
      ></app-button>
      </div>
      <div *ngIf="this.currentPlan['amount'] <  this.obj['planPrice']  && this.isAnyActiveSubscription" class="w-full sm:w-3/4 md:w-5/12 lg:w-3/12 mt-1">

        <app-button
        [arrow]="true"
        (myMethod)="upgradePlan()"
        padding="px-5 py-3 "
        value="Upgrade Plan"
      ></app-button>
      </div>
      <div *ngIf="this.currentPlan['amount'] > this.obj['planPrice'] && this.isAnyActiveSubscription"  class="w-full sm:w-3/4 md:w-5/12 lg:w-3/12 mt-1">

        <app-button
        [arrow]="true"
        (myMethod)="upgradePlan()"
        padding="px-5 py-3 "
        value="Downgrade Plan"
      ></app-button>
      </div>
      <div [routerLink]="['/home/subscriptionHistory']" 
      routerLinkActive="" class="flex flex-row items-center space-x-3 justify-center w-full my-2 sm:hidden">

        <div class="font-[GilroyBold]  text-center text-lg cursor-pointer">Subscription History</div>
        <div><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-black inline-block  cursor-pointer right-4 top-0 bottom-0 m-auto"  fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg></div>
      </div>
      <!-- <button class="bg-red text-white rounded-2xl h-12 w-48 text-sm mt-4" (click) = "upgradePlan()">Upgrade Plan</button> -->
    </div>
  </div>
  
</div>


<div *ngIf="payment">
<app-payment [data]="obj" [payment]="payment" (closePayment)="this.payment = false"></app-payment>
</div>

<app-modal-filter [modalBody]='modalBody1' [showModal]="toggleModalCancel">

  <ng-template #modalBody1>
    <div class="flex flex-col justify-center p-3">
      <div class="font-['GilroyBold'] py-5 text-center">Do You sure Want to cancel subscription?</div>
      <div class="flex flex-row w-full justify-between p-2 space-x-4">
        <div class="py-3 bg-red rounded-lg cursor-pointer w-1/2 items-center text-center font-['GilroySemi']" (click)="cancelSubscription()">Yes</div>
        <div class="py-3 bg-red rounded-lg cursor-pointer w-1/2 items-center text-center font-['GilroySemi']" (click)="toggleModalCancel=false">No</div>
      </div>
    </div>
  </ng-template>
</app-modal-filter>
<app-modal-filter [modalBody]='modalBody2' [showModal]="toggleModalChange">

  <ng-template #modalBody2>
    <div class="flex flex-col justify-center p-3">
      <div class="font-['GilroyBold'] py-5 text-center">Do You sure Want to cancel subscription?</div>
      <div class="flex flex-row w-full justify-between p-2 space-x-4">
        <div class="py-3 bg-red rounded-lg cursor-pointer w-1/2 items-center text-center font-['GilroySemi']" (click)="cancelSubscription()">Yes</div>
        <div class="py-3 bg-red rounded-lg cursor-pointer w-1/2 items-center text-center font-['GilroySemi']" (click)="toggleModalChange=false">No</div>
      </div>
    </div>
  </ng-template>
</app-modal-filter>